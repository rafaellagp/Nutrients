
library(cowplot)
library(rlang)
library(gridExtra)
library(ggplot2)


apatheme=theme_bw()+
  theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        panel.border=element_blank(),
        axis.line=element_line(),
        text=element_text(family='Times', size = 13),
        legend.position="none",
        legend.title=element_blank())


log_nut_100g <- read.table(text = "Pollinator_dependence	dependence	Protein	Lipid	Carbohydrate	Fiber	Calcium	Iron	Magnesium	Phosphorus	Potassium	Sodium	Zinc	VitaminC	Thiamin	Riboflavin	Niacin	VitaminB6	Folate	VitaminA	VitaminE	VitaminK
Essential	PD	0.290034611	0.056904851	1.309630167	0.503790683	1.117271296	0.100370545	1.408239965	1.014520539	1.860936621	0.230448921	0.201397124	1.164352856	0.096910013	0	0	0.017033339	0	0	0	0
Essential	PD	0.264817823	0.075546961	0.961895474	0.278753601	1	0.08278537	1.113943352	1.204119983	2.428134794	1.230448921	0.071882007	1.57634135	0.017033339	0.008600172	0.238046103	0.029383778	0.008600172	0.068185862	0.021189299	0
Essential	PD	0.505149978	0.230448921	1.387033701	1.056904851	1.113943352	0.414973348	1.477121255	1.838849091	2.542825427	1.462397998	0.041392685	1.491361694	0	0.053078443	0.397940009	0.041392685	0.004321374	0.025305865	0.008600172	0
Essential	PD	0.206825876	0.06069784	0.931966115	0.146128036	0.903089987	0.093421685	1.041392685	1.079181246	2.053078443	0.301029996	0.041392685	0.959041392	0.012837225	0.008600172	0.071882007	0.021189299	0	0.012837225	0.021189299	0
Great	PD	0.103803721	0.053078443	1.138302698	0.361727836	0.77815125	0.029383778	0.698970004	1.079181246	1.959041392	0	0.021189299	0.698970004	0.008600172	0.012837225	0.037426498	0.017033339	0	0	0.004321374	0
Great	PD	0.471291711	1.194791758	0.979092901	0.886490725	1.113943352	0.190331698	1.477121255	1.72427587	2.686636269	0.903089987	0.214843848	1.041392685	0.029383778	0.053078443	0.437750563	0.100370545	0.033423755	0.004321374	0.487138375	0.860017176
Great	PD	1.283753383	1.62838893	1.494015375	0.633468456	1.579783597	0.88536122	2.46686762	2.773786445	2.820201459	1.113943352	0.831229694	0.176091259	0.152288344	0.025305865	0.31386722	0.152288344	0.012837225	0	0.278753601	1.283722471
Great	PD	0.269512944	0.184691431	1.158362492	0.831229694	0.872156273	0.068185862	0.989004616	1.227886705	2.320146286	0.477121255	0.068185862	1.958563883	0.029383778	0.017033339	0.318063335	0.012837225	0.017033339	0.021189299	0.149219113	0
Great	PD	0.260071388	0.139879086	1.203576775	0.414973348	1.079181246	0.064457989	1.041392685	1.176091259	2.227886705	0.301029996	0.037426498	1.572871602	0.012837225	0.017033339	0.222716471	0.049218023	0.017033339	0.021189299	0.278753601	0
Great	PD	0.281033367	0.103803721	1.045322979	0.397940009	0.84509804	0.127104798	0.954242509	1.361727836	2.089905111	1.146128036	0.089905111	0.707570176	0.008600172	0.012837225	0.257678575	0.012837225	0.004321374	0.008600172	0	0
Great	PD	0.133538908	0.056904851	1.21031852	0.612783857	1	0.071882007	0.903089987	1.113943352	2.068185862	0.301029996	0.041392685	0.72427587	0.004321374	0.012837225	0.064457989	0.012837225	0.004321374	0	0	1.70333393
Great	PD	0	2.004321374	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1.624075731	0.432137378
Great	PD	0.274157849	0.079181246	0.689308859	0.342422681	1.041392685	0.103803721	1.079181246	1.397940009	2.376576957	0.77815125	0.068185862	1.167317335	0.017033339	0.008600172	0.201397124	0.033423755	0.008600172	0.017033339	0	0.432137378
Little	PD	1.36361198	0.457881897	1.629409599	1.330413773	2.029383778	0.902546779	2.170261715	2.565847819	3.134177108	0.290034611	0.583198774	0.5132176	0.068185862	0	0.709269961	0.222716471	0.181843588	0	0.120573931	2.530586526
Little	PD	1.326335861	0.527629901	1.605305046	1.390935107	2.003891166	0.814913181	2.252853031	2.602059991	3.06669855	1.053078443	0.674861141	0	0.056904851	0.012837225	0	0.100370545	0.212187604	0.017033339	0.238046103	0.860017176
Little	PD	1.433769834	1.620136055	1.226084116	1.021189299	2.029383778	0.691081492	2.276461804	2.589949601	2.872156273	1.361727836	0.494154594	0	0.222716471	0.056904851	1.228400359	0.130333768	0.093421685	0	0.004321374	0
Little	PD	0.120573931	0.113943352	0.795880017	0.579783597	1.049218023	0.033423755	0.993876915	1.08278537	2.079181246	0.477121255	0	1.5289167	0.017033339	0.008600172	0.041392685	0.033423755	0.004321374	0	0.086359831	0
Little	PD	0.257678575	0.117271296	1.156549151	0.447158031	1.579783597	0.06069784	1.113943352	1.322219295	2.222716471	0.477121255	0.029383778	1.442479769	0.025305865	0.017033339	0.139879086	0.033423755	0.008600172	0.012837225	0.079181246	0
Little	PD	0	2.004321374	0	0	0	0.004321374	0	0	0	0	0	0	0.041392685	0	0.836324116	0	0	0.783188691	1.227886705	0
Little	PD	0.26245109	0.133538908	1.130333768	0.587710965	1.552668216	0.056904851	1.133538908	1.387389826	2.267171728	0.298853076	0.053078443	1.747411808	0.033423755	0.021189299	0.278753601	0.017033339	0.012837225	0	0.187520721	0
Little	PD	0.167317335	0.100370545	1.072617477	0.431363764	1.322219295	0.096910013	1.342422681	1.041392685	2.26245109	0.954242509	0.033423755	1.791690649	0.008600172	0.012837225	0.133538908	0.017033339	0.017033339	0.021189299	0.113943352	0
Little	PD	0.170261715	0.079181246	1.285557309	0.745074792	1.136720567	0.037426498	0.674861141	1.269512944	2.195899652	0.489958479	0.045322979	1.334453751	0	0	0	0.012837225	0.252853031	0.049218023	0.247973266	0
Modest	PD	0.278753601	0.778874472	0.937517892	0.838219222	1.338456494	0.201397124	1.340444115	1.326335861	2.045322979	0.42975228	0.089905111	1.633468456	0	0.017033339	0	0.033423755	0	0.056904851	1.198657087	0
Modest	PD	1.419955748	0.372912003	1.609594409	1.338456494	1.984977126	0.791690649	2.133538908	2.635483747	3.077004327	1.414973348	0.658011397	0.380211242	0.193124598	0.089905111	0.532754379	0.117271296	0.096910013	0	0.017033339	0.432137378
Modest	PD	0.671172843	1.633468456	1.056904851	0.804820679	0.986323777	0.33243846	1.660865478	1.856124444	2.488550717	1.212187604	0.413299764	0.542825427	0.025305865	0.008600172	0.187520721	0.012837225	0.012837225	0	0.113943352	0
Modest	PD	1.195899652	1.11058971	1.588831726	1.505149978	2.029383778	0.960470778	2.220108088	2.230448921	3.206556044	0.328379603	0.181843588	2.437274797	0.008600172	0.025305865	0.146128036	0.004321374	0.004321374	0.017033339	0	0
Modest	PD	0.243038049	0.113943352	1.304921162	0.591064607	1.556302501	0.136720567	1.255272505	1.176091259	2.367355921	0.301029996	0.06069784	0.477121255	0.025305865	0.021189299	0.146128036	0.045322979	0.004321374	0.004321374	0.045322979	0
Modest	PD	0.568201724	0.079181246	1.425044875	0.397940009	1.278753601	0.42975228	1.041392685	2.149219113	3.256958153	1.176091259	0.674861141	0.954242509	0.021189299	0.071882007	0.278753601	0.257678575	0.008600172	0	0	0
Modest	PD	1.144574208	0.892094603	1.080987047	0.716003344	2.29666519	0.658011397	1.819543936	2.290034611	2.7930916	1.204119983	0.298853076	1.477121255	0.158362492	0.071882007	0.423245874	0.029383778	0.068185862	0.004321374	0	0
ND	ND	0.320146286	0.123851641	1.377306251	0.556302501	0.77815125	0.100370545	1.447158031	1.361727836	2.555094449	0.301029996	0.06069784	0.986771734	0.012837225	0.029383778	0.222716471	0.136720567	0.008600172	0	0.041392685	0.432137378
ND	ND	1.10720997	0.532754379	1.788875116	1.206825876	1.440909082	0.532754379	1.834420704	2.394451681	2.519827994	0.655138435	0.57634135	0	0.064457989	0.033423755	0.814913181	0.113943352	0.012837225	0	0.096910013	0
ND	ND	0.29666519	0.086359831	1.51851394	0.489958479	1.170261715	0.096910013	1.617000341	1.442479769	2.276461804	0.469822016	0.071882007	1.204119983	0.037426498	0.021189299	0.267171728	0.017033339	0.008600172	0.004321374	0.06069784	0
ND	ND	0.630427875	0.371067862	1.294466226	0.477121255	0.477121255	0.181843588	1.579783597	1.954242509	2.432969291	1.204119983	0.164352856	0.892094603	0.064457989	0.025305865	0.442479769	0.037426498	0.017033339	0.004321374	0.029383778	0
ND	ND	0.866877814	0.176091259	1.532244644	0.491361694	2.260071388	0.431363764	1.414973348	2.187520721	2.604226053	1.255272505	0.334453751	1.507855872	0.079181246	0.045322979	0.230448921	0.350248018	0	0	0.033423755	0
ND	ND	0.235528447	0.064457989	1.281033367	0.278753601	1.041392685	0.133538908	0.903089987	1.322219295	2.283301229	0.477121255	0.029383778	0.62324929	0.029383778	0.029383778	0.075546961	0.037426498	0	0	0	0.432137378
ND	ND	1.252610341	0.897627091	1.757927183	1.064457989	1.740362689	0.757396029	2.250420002	2.719331287	2.633468456	0.477121255	0.696356389	0	0.245512668	0.056904851	0.292256071	0.049218023	0.025305865	0	0	0
ND	ND	0.264817823	1.075546961	0.847572659	0.414973348	1.949390007	0.862131379	0.698970004	0.602059991	0.954242509	2.866877814	0.086359831	0.278753601	0	0	0.017033339	0.004321374	0	0.008600172	0.423245874	0
ND	ND	0.322219295	0.041392685	1.014520539	0.431363764	1.380211242	0.08278537	1.041392685	1.477121255	2.167317335	0.698970004	0.068185862	0.924279286	0.021189299	0.012837225	0.049218023	0.049218023	0.008600172	0	0.008600172	0
ND	ND	0.190331698	0.053078443	1.107888025	0.380211242	1.146128036	0.096910013	1.113943352	1	2.100370545	0.301029996	0.033423755	1.688419822	0.033423755	0.012837225	0.176091259	0.045322979	0.008600172	0	0.008600172	0
ND	ND	0.484299839	0.037426498	1.257678575	0.491361694	1.113943352	0.257678575	1.380211242	1.763427994	2.629409599	0.84509804	0.113943352	1.315970345	0.033423755	0.012837225	0.31386722	0.113943352	0.008600172	0	0.004321374	0
ND	ND	0.931457871	0.62324929	1.870111155	0.662757832	1	0.359835482	2.068185862	2.494154594	2.399673721	0.77815125	0.495544338	0	0.187520721	0.041392685	0.874481818	0.170261715	0.008600172	0	0.204119983	0
ND	ND	1.054613055	0.419955748	1.794488047	1.206825876	1.397940009	0.559906625	2.045322979	2.522444234	2.7084209	0.477121255	0.562292864	0	0.11058971	0	0	0.033423755	0.012837225	0	0	0
ND	ND	1.065206128	0.649334859	1.826074803	0.886490725	1.146128036	0.639486489	2.220108088	2.462397998	2.561101384	0.477121255	0.426511261	0	0.123851641	0.041392685	0.671172843	0.158362492	0.008600172	0	0.176091259	0
ND	ND	0.542825427	0.178976947	0.992111488	0.799340549	1.897627091	0.294466226	1.851258349	1.913813852	2.706717782	0.84509804	0.113943352	1.079181246	0.064457989	0.130333768	0.328379603	0.075546961	0	0.075546961	0.100370545	11.39433523
ND	ND	1.166726056	0.540329475	1.821513528	0.886490725	1.51851394	0.655138435	2.161368002	2.706717782	2.635483747	0.477121255	0.712649702	0	0.152288344	0.049218023	0.888740961	0.152288344	0	0.017033339	0	0", sep = "", header = TRUE)



#boxplot nut 100g dados em log10 com categorias de dependencia Dependent vs Non-Dependent-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

n1<-ggplot(data=log_nut_100g, aes(x=dependence, y=  Lipid,
                                  fill=dependence)) + 
  geom_violin(trim=FALSE, color="white")+
  geom_boxplot(width=0.1, fill="black", outlier.colour = "Black", outlier.shape = 20)+
  stat_summary(fun='median', geom='point', shape=20, size = 1, col='white')+
  labs(x="", y="Total lipids")+
  apatheme + scale_fill_manual(values=c("#ADD8E6","red"))

n2<-ggplot(data=log_nut_100g, aes(x=dependence, y= Carbohydrate,
                                  fill=dependence)) + 
  geom_violin(trim=FALSE, color="white")+
  geom_boxplot(width=0.1, fill="black", outlier.colour = "Black", outlier.shape = 20)+
  stat_summary(fun='median', geom='point', shape=20, size = 1, col='white')+
  labs(x="", y="Carbohydrate")+
  apatheme + scale_fill_manual(values=c("#ADD8E6","red"))

n3<-ggplot(data=log_nut_100g, aes(x=dependence, y= VitaminC,
                                  fill=dependence)) + 
  geom_violin(trim=FALSE, color="white")+
  geom_boxplot(width=0.1, fill="black", outlier.colour = "Black", outlier.shape = 20)+
  stat_summary(fun='median', geom='point', shape=20, size = 1, col='white')+
  labs(x="", y="Vitamin C")+
  apatheme + scale_fill_manual(values=c("#ADD8E6","red"))

n4<-ggplot(data=log_nut_100g, aes(x=dependence, y= Folate,
                                  fill=dependence)) + 
  geom_violin(trim=FALSE, color="white")+
  geom_boxplot(width=0.1, fill="black", outlier.colour = "Black", outlier.shape = 20)+
  stat_summary(fun='median', geom='point', shape=20, size = 1, col='white')+
  labs(x="", y="Vitamin B9 - Folate")+
  apatheme + scale_fill_manual(values=c("#ADD8E6","red"))

n5<-ggplot(data=log_nut_100g, aes(x=dependence, y= VitaminE,
                                  fill=dependence)) + 
  geom_violin(trim=FALSE, color="white")+
  geom_boxplot(width=0.1, fill="black", outlier.colour = "Black", outlier.shape = 20)+
  stat_summary(fun='median', geom='point', shape=20, size = 1, col='white')+
  labs(x="", y="Vitamin E")+
  apatheme + scale_fill_manual(values=c("#ADD8E6","red"))

fig<-grid.arrange(n2,n1,n4, nrow=1)
